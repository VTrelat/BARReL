\RequirePackage{listings}
% \RequirePackage{amssymb}

% Listing style definition for the Lean Theorem Prover.
% Defined by Jeremy Avigad, 2015, by modifying Assia Mahboubi's SSR style.
% Unicode replacements taken from Olivier Verdier's unixode.sty

\lstdefinelanguage{Lean} {
% Anything between $ becomes LaTeX math mode
mathescape=false,
% Comments may or not include Latex commands
texcl=false,
% keywords, list taken from lean-syntax.el
morekeywords=[1]{
		import, prelude, protected, private, noncomputable, definition, meta, renaming, scoped,
		hiding, parameter, parameters, begin, constant, constants,
		lemma, variable, variables, theory,
		print, theorem, example,
		open, as, export, override, axiom, axioms, inductive, with,
		structure, record, universe, universes,
		alias, help, precedence, reserve, declare_trace, add_key_equivalence,
		match, infix, infixl, infixr, notation, postfix, prefix, instance,
		eval, reduce, check, end, this,
		using, using_well_founded, namespace, section,
		attribute, local, set_option, extends, include, omit, class,
		raw, replacing,
		calc, have, by, in, at, let, forall, Pi, fun,
		if, dif, then, else, assume, obtain, from, register_simp_ext, unless, break, continue,
		mutual, do, def, run_cmd, const,
		partial, mut, where, macro, syntax, deriving,
		return, try, catch, for, macro_rules, declare_syntax_cat, abbrev,
		prove_obligations_of, machine, system, refinement, implementation, pog},
% Sorts
morekeywords=[2]{Sort, Type, Prop},
% tactics, list taken from lean-syntax.el
% TODO: maybe add some of the mathlib tactics?
morekeywords=[3]{
		assumption,
		apply, intro, intros, allGoals,
		generalize, clear, revert, done, exact,
		refine, repeat, cases, rewrite, rw, next,
		simp, simp_all, contradiction,
		constructor, injection,
		induction, show, suffices, exists,
	},
% modifiers, taken from lean-syntax.el
% note: 'otherkeywords' is needed because these use a different symbol.
% this command doesn't allow us to specify a number -- they are put with [1]
% otherkeywords={
% [persistent], [notation], [visible], [instance], [trans_instance],
% [class], [parsing-only], [coercion], [unfold_full], [constructor],
% [reducible], [irreducible], [semireducible], [quasireducible], [wd],
% [whnf], [multiple_instances], [none], [decl], [declaration],
% [relation], [symm], [subst], [refl], [trans], [simp], [congr], [unify],
% [backward], [forward], [no_pattern], [begin_end], [tactic], [abbreviation],
% [reducible], [unfold], [alias], [eqv], [intro], [intro!], [elim], [grinder],
% [localrefinfo], [recursor]
% },
% Various symbols
literate=
	{Œ±}{{\ensuremath{\mathrm{\alpha}}}}1
{Œ≤}{{\ensuremath{\mathrm{\beta}}}}1
% {Œ≥}{{\ensuremath{\mathrm{\gamma}}}}1
% {Œ¥}{{\ensuremath{\mathrm{\delta}}}}1
% {Œµ}{{\ensuremath{\mathrm{\varepsilon}}}}1
% {Œ∂}{{\ensuremath{\mathrm{\zeta}}}}1
% {Œ∑}{{\ensuremath{\mathrm{\eta}}}}1
% {Œ∏}{{\ensuremath{\mathrm{\theta}}}}1
% {Œπ}{{\ensuremath{\mathrm{\iota}}}}1
% {Œ∫}{{\ensuremath{\mathrm{\kappa}}}}1
% {Œº}{{\ensuremath{\mathrm{\mu}}}}1
% {ŒΩ}{{\ensuremath{\mathrm{\nu}}}}1
% {Œæ}{{\ensuremath{\mathrm{\xi}}}}1
% {œÄ}{{\ensuremath{\mathrm{\mathnormal{\pi}}}}}1
% {œÅ}{{\ensuremath{\mathrm{\rho}}}}1
% {œÉ}{{\ensuremath{\mathrm{\sigma}}}}1
% {œÑ}{{\ensuremath{\mathrm{\tau}}}}1
% {œÜ}{{\ensuremath{\mathrm{\varphi}}}}1
% {œá}{{\ensuremath{\mathrm{\chi}}}}1
% {œà}{{\ensuremath{\mathrm{\psi}}}}1
% {œâ}{{\ensuremath{\mathrm{\omega}}}}1
% {Œì}{{\ensuremath{\mathrm{\Gamma}}}}1
% {Œî}{{\ensuremath{\mathrm{\Delta}}}}1
% {Œò}{{\ensuremath{\mathrm{\Theta}}}}1
% {Œõ}{{\ensuremath{\mathrm{\Lambda}}}}1
% {Œ£}{{\ensuremath{\mathrm{\Sigma}}}}1
% {Œ¶}{{\ensuremath{\mathrm{\Phi}}}}1
% {Œû}{{\ensuremath{\mathrm{\Xi}}}}1
% {Œ®}{{\ensuremath{\mathrm{\Psi}}}}1
% {Œ©}{{\ensuremath{\mathrm{\Omega}}}}1
{‚Ñµ}{{\ensuremath{\aleph}}}1
{‚â§}{{\ensuremath{\leq}}}1
{‚â•}{{\ensuremath{\geq}}}1
{‚â†}{{\ensuremath{\neq}}}1
{‚âà}{{\ensuremath{\approx}}}1
{‚â°}{{\ensuremath{\equiv}}}1
{‚âÉ}{{\ensuremath{\simeq}}}1
{‚â§}{{\ensuremath{\leq}}}1
{‚â•}{{\ensuremath{\geq}}}1
{‚àÇ}{{\ensuremath{\partial}}}1
{‚àÜ}{{\ensuremath{\triangle}}}1 % or \laplace?
{‚à´}{{\ensuremath{\int}}}1
{‚àë}{{\ensuremath{\mathrm{\Sigma}}}}1
{Œ†}{{\ensuremath{\mathrm{\Pi}}}}1
{‚ä•}{{\ensuremath{\perp}}}1
{‚àû}{{\ensuremath{\infty}}}1
{‚àÇ}{{\ensuremath{\partial}}}1
{‚àì}{{\ensuremath{\mp}}}1
{¬±}{{\ensuremath{\pm}}}1
{√ó}{{\ensuremath{\times}}}1
{‚äï}{{\ensuremath{\oplus}}}1
{‚äó}{{\ensuremath{\otimes}}}1
{‚äû}{{\ensuremath{\boxplus}}}1
{‚àá}{{\ensuremath{\nabla}}}1
{‚àö}{{\ensuremath{\sqrt}}}1
{‚¨ù}{{\ensuremath{\cdot}}}1
{‚Ä¢}{{\ensuremath{\cdot}}}1
{‚àò}{{\ensuremath{\circ}}}1
%{‚Åª}{{\ensuremath{^{\textup{\kern1pt\rule{2pt}{0.3pt}\kern-1pt}}}}}1
{‚Åª}{{\ensuremath{^{-}}}}1
{‚ñ∏}{{\ensuremath{\blacktriangleright}}}1
% {‚àß}{{\ensuremath{\wedge}}}1
% {‚à®}{{\ensuremath{\vee}}}1
{¬¨}{{\ensuremath{\neg}}}1
{‚ä¢}{{\ensuremath{\vdash}}}1
%{‚ü®}{{\ensuremath{\left\langle}}}1
%{‚ü©}{{\ensuremath{\right\rangle}}}1
{‚ü®}{{\ensuremath{\langle}}}1
{‚ü©}{{\ensuremath{\rangle}}}1
{‚Ü¶}{{\ensuremath{\mapsto}}}1
{‚Üê}{{\ensuremath{\leftarrow}}}1
% {<-}{{\ensuremath{\leftarrow}}}1
% {‚Üí}{{\ensuremath{\rightarrow}}}1
{‚Üî}{{\ensuremath{\leftrightarrow}}}1
{‚ü∑}{{\ensuremath{\longleftrightarrow}}}1
{‚áí}{{\ensuremath{\Rightarrow}}}1
{‚üπ}{{\ensuremath{\Longrightarrow}}}1
{‚áê}{{\ensuremath{\Leftarrow}}}1
{‚ü∏}{{\ensuremath{\Longleftarrow}}}1
{‚ü∂}{{\ensuremath{\longrightarrow}}}1
{‚á∏}{{\ensuremath{\pfun}}}1
{‚§î}{{\ensuremath{\pinj}}}1
{‚Ü£}{{\ensuremath{\tinj}}}1
{‚©§}{{\ensuremath{\ndres}}}1
{‚à©}{{\ensuremath{\cap}}}1
{‚à™}{{\ensuremath{\cup}}}1
{‚äÇ}{{\ensuremath{\subseteq}}}1
{‚äÜ}{{\ensuremath{\subseteq}}}1
{‚äÑ}{{\ensuremath{\nsubseteq}}}1
{‚äà}{{\ensuremath{\nsubseteq}}}1
{‚äÉ}{{\ensuremath{\supseteq}}}1
{‚äá}{{\ensuremath{\supseteq}}}1
{‚äÖ}{{\ensuremath{\nsupseteq}}}1
{‚äâ}{{\ensuremath{\nsupseteq}}}1
{‚àà}{{\ensuremath{\in}}}1
{‚àâ}{{\ensuremath{\notin}}}1
{‚àã}{{\ensuremath{\ni}}}1
{‚àå}{{\ensuremath{\notni}}}1
{‚àÖ}{{\ensuremath{\emptyset}}}1
{‚àñ}{{\ensuremath{\setminus}}}1
{‚Ä†}{{\ensuremath{\dag}}}1
{‚Ñï}{{\ensuremath{\mathbb{N}}}}1
{‚Ñ§}{{\ensuremath{\mathbb{Z}}}}1
{‚Ñù}{{\ensuremath{\mathbb{R}}}}1
{‚Ñö}{{\ensuremath{\mathbb{Q}}}}1
{‚ÑÇ}{{\ensuremath{\mathbb{C}}}}1
{‚åû}{{\ensuremath{\llcorner}}}1
{‚åü}{{\ensuremath{\lrcorner}}}1
{‚¶É}{{\ensuremath{\{\!|}}}1
{‚¶Ñ}{{\ensuremath{|\!\}}}}1
{‚Äñ}{{\ensuremath{\|}}}1
{‚ÇÅ}{{\ensuremath{_1}}}1
% {‚ÇÇ}{{\ensuremath{_2}}}1
% {‚ÇÉ}{{\ensuremath{_3}}}1
% {‚ÇÑ}{{\ensuremath{_4}}}1
% {‚ÇÖ}{{\ensuremath{_5}}}1
% {‚ÇÜ}{{\ensuremath{_6}}}1
% {‚Çá}{{\ensuremath{_7}}}1
% {‚Çà}{{\ensuremath{_8}}}1
% {‚Çâ}{{\ensuremath{_9}}}1
% {‚ÇÄ}{{\ensuremath{_0}}}1
{·µ¢}{{\ensuremath{_i}}}1
{‚±º}{{\ensuremath{_j}}}1
{‚Çê}{{\ensuremath{_a}}}1
{¬π}{{\ensuremath{^1}}}1
{‚Çô}{{\ensuremath{_n}}}1
{‚Çò}{{\ensuremath{_m}}}1
{‚Çö}{{\ensuremath{_p}}}1
{À¢}{{\ensuremath{^s}}}1
{‚Üë}{{\ensuremath{\uparrow}}}1
{‚Üì}{{\ensuremath{\downarrow}}}1
{‚ãØ}{{\ensuremath{\leanpf}}}1
% {¬∑}{{\ensuremath{\cdot}}}1
{‚ñ∏}{{\ensuremath{\triangleright}}}1
{Œ£}{{\color{symbolcolor}\ensuremath{\Sigma}}}1
{Œ†}{{\color{symbolcolor}\ensuremath{\Pi}}}1
{‚àÄ}{{\textcolor{symbolcolor}{\ensuremath{\forall}}}}1
{‚àÉ}{{\textcolor{symbolcolor}{\ensuremath{\exists}}}}1
{Œª}{{\color{symbolcolor}\ensuremath{\mathrm{\lambda}}}}1
{\$}{{\color{symbolcolor}\$}}1
{:=}{{\textcolor{symbolcolor}{:=}}}2
{=>}{{\textcolor{symbolcolor}{=>}}}2
% {=}{{\color{symbolcolor}=}}1
{<|>}{{\color{symbolcolor}<|>}}3
{<\$>}{{\color{symbolcolor}<\$>}}3
{+}{{\color{symbolcolor}+}}1
{*}{{\textcolor{symbolcolor}*}}1
{ùí´}{{\ensuremath{\mathcal{P}}}}1,
% Comments
%comment=[s][\itshape \color{commentcolor}]{/-}{-/},
morecomment=[s]{/-}{-/},
morecomment=[l]{--},
% String delimiters
morestring=[b]",
morestring=[d]¬í,
%
extendedchars=true,
}



%% Patch listing to accept our unicode characters 
% \lst@InputCatcodes
% \def\lst@DefEC{%
% 	\lst@CCECUse \lst@ProcessLetter
% 	%% ASCII
% 	^^80^^81^^82^^83^^84^^85^^86^^87^^88^^89^^8a^^8b^^8c^^8d^^8e^^8f%
% 	^^90^^91^^92^^93^^94^^95^^96^^97^^98^^99^^9a^^9b^^9c^^9d^^9e^^9f%
% 	^^a0^^a1^^a2^^a3^^a4^^a5^^a6^^a7^^a8^^a9^^aa^^ab^^ac^^ad^^ae^^af%
% 	^^b0^^b1^^b2^^b3^^b4^^b5^^b6^^b7^^b8^^b9^^ba^^bb^^bc^^bd^^be^^bf%
% 	^^c0^^c1^^c2^^c3^^c4^^c5^^c6^^c7^^c8^^c9^^ca^^cb^^cc^^cd^^ce^^cf%
% 	^^d0^^d1^^d2^^d3^^d4^^d5^^d6^^d7^^d8^^d9^^da^^db^^dc^^dd^^de^^df%
% 	^^e0^^e1^^e2^^e3^^e4^^e5^^e6^^e7^^e8^^e9^^ea^^eb^^ec^^ed^^ee^^ef%
% 	^^f0^^f1^^f2^^f3^^f4^^f5^^f6^^f7^^f8^^f9^^fa^^fb^^fc^^fd^^fe^^ff%
% 	%% Greek latters 
% 	^^^^0391^^^^0392^^^^0393^^^^0394^^^^0395^^^^0396^^^^0397^^^^0398%
% 	^^^^0399^^^^039a^^^^039b^^^^039c^^^^039d^^^^039e^^^^039f^^^^03a0%
% 	^^^^03a1^^^^03a2^^^^03a3^^^^03a4^^^^03a5^^^^03a6^^^^03a7^^^^03a8%
% 	^^^^03a9^^^^03aa^^^^03ab^^^^03ac^^^^03ad^^^^03ae^^^^03af^^^^03b0%
% 	^^^^03b1^^^^03b2^^^^03b3^^^^03b4^^^^03b5^^^^03b6^^^^03b7^^^^03b8%
% 	^^^^03b9^^^^03ba^^^^03bb^^^^03bc^^^^03bd^^^^03be^^^^03bf^^^^03c0%
% 	^^^^03c1^^^^03c2^^^^03c3^^^^03c4^^^^03c5^^^^03c6^^^^03c7^^^^03c8%
% 	^^^^03c9%
% 	%% Subscripts
% 	^^^^2080^^^^2081^^^^2082^^^^2083^^^^2084^^^^2085^^^^2086^^^^2087%
% 	^^^^2088^^^^2089%
% 	%% Misc maths 
% 	^^^^2200^^^^2203^^^^2192^^^^2227^^^^2228%
% 	^^00}
% \lst@RestoreCatcodes